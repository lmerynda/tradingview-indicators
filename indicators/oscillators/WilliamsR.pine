// This source code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© TradingView Indicators

//@version=5
indicator("Williams %R", shorttitle="%R", overlay=false)

// Inputs
length = input.int(14, minval=1, title="Length")
overbought = input.int(-20, minval=-50, maxval=0, title="Overbought Level")
oversold = input.int(-80, minval=-100, maxval=-50, title="Oversold Level")

// Williams %R Calculation
range_value = ta.highest(high, length) - ta.lowest(low, length)
williamsR = range_value != 0 ? -100 * (ta.highest(high, length) - close) / range_value : -50

// Plot
plot(williamsR, title="Williams %R", color=color.blue, linewidth=2)
hline(overbought, title="Overbought", color=color.red, linestyle=hline.style_dashed)
hline(oversold, title="Oversold", color=color.green, linestyle=hline.style_dashed)
hline(-50, title="Middle Line", color=color.gray, linestyle=hline.style_dotted)

// Color the background when overbought or oversold
bgcolor(williamsR > overbought ? color.new(color.red, 90) : na, title="Overbought Background")
bgcolor(williamsR < oversold ? color.new(color.green, 90) : na, title="Oversold Background")

// Alert conditions
alertcondition(ta.cross(williamsR, overbought), title="%R Crosses Overbought", message="Williams %R crossed above overbought level")
alertcondition(ta.cross(oversold, williamsR), title="%R Crosses Oversold", message="Williams %R crossed below oversold level")
