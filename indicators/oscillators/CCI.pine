// This source code is subject to the terms of the Mozilla Public License 2.0 at https://mozilla.org/MPL/2.0/
// Â© TradingView Indicators

//@version=5
indicator("Commodity Channel Index (CCI)", shorttitle="CCI", overlay=false)

// Inputs
length = input.int(20, minval=1, title="CCI Length")
src = input.source(hlc3, title="Source")
overbought = input.int(100, minval=50, maxval=200, title="Overbought Level")
oversold = input.int(-100, minval=-200, maxval=-50, title="Oversold Level")

// CCI Calculation
cci = ta.cci(src, length)

// Plot
plot(cci, title="CCI", color=color.blue, linewidth=2)
hline(overbought, title="Overbought", color=color.red, linestyle=hline.style_dashed)
hline(oversold, title="Oversold", color=color.green, linestyle=hline.style_dashed)
hline(0, title="Zero Line", color=color.gray, linestyle=hline.style_solid)

// Color the background when overbought or oversold
bgcolor(cci > overbought ? color.new(color.red, 90) : na, title="Overbought Background")
bgcolor(cci < oversold ? color.new(color.green, 90) : na, title="Oversold Background")

// Alert conditions
alertcondition(ta.cross(cci, overbought), title="CCI Crosses Overbought", message="CCI crossed above overbought level")
alertcondition(ta.cross(oversold, cci), title="CCI Crosses Oversold", message="CCI crossed below oversold level")
alertcondition(ta.cross(cci, 0), title="CCI Zero Cross", message="CCI crossed zero line")
